Dictionary-driven protein annotation
Computational methods seeking to automatically determine the properties (functional, structural, physicochemical, etc.) of a protein directly from the sequence have long been the focus of numerous research groups. With the advent of advanced sequencing methods and systems, the number of amino acid sequences that are being deposited in the public databases has been increasing steadily. This has in turn generated a renewed demand for automated approaches that can annotate individual sequences and complete genomes quickly, exhaustively and objectively. In this paper, we present one such approach that is centered around and exploits the Bio-Dictionary, a collection of amino acid patterns that completely covers the natural sequence space and can capture functional and structural signals that have been reused during evolution, within and across protein families. Our annotation approach also makes use of a weighted, position-specific scoring scheme that is unaffected by the over-representation of well-conserved proteins and protein fragments in the databases used. For a given query sequence, the method permits one to determine, in a single pass, the following: local and global similarities between the query and any protein already present in a public database; the likeness of the query to all available archaeal /bacterial /eukaryotic /viral sequences in the database as a function of amino acid position within the query; the character of secondary structure of the query as a function of amino acid position within the query; the cytoplasmic, transmembrane or extracellular behavior of the query; the nature and position of binding domains, active sites, post-translationally modified sites, signal peptides, etc. In terms of performance, the proposed method is exhaustive, objective and allows for the rapid annotation of individual sequences and full genomes. Annotation examples are presented and discussed in Results, including individual queries and complete genomes that were released publicly after we built the Bio-Dictionary that is used in our experiments. Finally, we have computed the annotations of more than 70 complete genomes and made them available on the World Wide Web at .

The automatic elucidation of protein function directly from sequence has been the focus of research activity for many years. Such an elucidation has an obvious appeal for it tries to minimize the amount of associated manual labor by reducing a large number of possibilities to one or a handful of choices. This is typically achieved by tapping into repositories of previously accumulated knowledge and by trading computation (i.e. in silico approaches) for typically tedious manual analysis. The discovery of protein function directly from sequence, in an automated or semi-automated manner, has become a fundamental question as thousands of unknown proteins and increasing numbers of complete genomes are made available daily in the public domain. Of course, one should not lose sight of the fact that protein annotation is the first step in the attempt to fully describe a particular organism through characterization of its metabolic pathways and transcription regulation networks. During the last three decades, numerous methods have been proposed for determining protein function from sequence, all of which are essentially instances of a 'guilty by association' approach to solving this problem. Depending on the nature of the information exploited and the manner in which the information is used, these methods can essentially be divided into a handful of well-differentiated categories. The chronologically earliest examples of protein annotation methods rely on the determination of a local or global similarity between a query protein and proteins with known annotation that are contained in a database ( --). If two sequences of comparable length share a large portion of their extent, the previously uncharaterized sequence will inherit the function of the annotated one. The validity of this scheme relies on the implicit assumption that two sequences that 'look the same' at the sequence level also have the same function and structure. This is a reasonable assumption, but counter-examples such as the dehydrogenase /z-crystallin case have also been documented in the literature (for a discussion of this particular case see for example ). The methods in this category are known as 'similarity-based' or 'homology-based' and are numerous. The approach we present in this paper belongs to this category as well. A recurrent situation within the similarity-method category that is pertinent to our discussion relates to the inclination of annotators to use either the first or the best 'hit' from the output of a database search that is carried out by one of the similarity search algorithms such as FASTA , BLAST , Smith-Waterman , etc. In the presence of domains that are shared by numerous proteins , choosing the first or the best hit may not be optimal. As a matter of fact, the multi-domain organization of proteins can lead to incorrectly annotated database entries (Fig.  shows a characteristic example of such a misannotation). Use of a domain scan and the exploitation /analysis of the generated output when annotating a query can substantially improve the results. Such a domain scan can be implemented, for example, with the help of the PROSITE, PRINTS, PFAM, BLOCKS or PRODOM databases ( --). For a description of other sources of potential concern in protein annotation and some recommended solutions the reader is referred to previous publications ( --). A second category of methods has become known as the Rosetta stone approach (also known as the domain fusion method) ( --). Here, one seeks to determine groups of proteins that are distinct in a given organism but appear as a single product in another organism, the result of an assumed fusion event. The distinct proteins in the original group are assumed to be physically interacting and, depending on the specifics of each case, this information can be helpful in determining protein function. The methods in the third category seek to determine groups of proteins that repeatedly appear as neighbors of one another in the chromosomes of different organisms. The proteins involved are assumed to have a functional relationship (this methodology is similar in flavor to the Rosetta stone approach but distinct with respect to the type of information that it uses). Exploitation of this idea has found a best fit in the case of prokaryotic genomes where proximal gene organization is manifested in the form of operons, and it has been used successfully to guide functional annotation . It is not evident, however, whether this idea carries over to eukaryotic organisms due to the fact that, in general, the latter lack operons. A closely related variation, which does extend to eukaryotic organisms, operates on the assumption that if an organism is in need of a specific pathway then the organism will carry all or most of the genes comprising the pathway, and vice versa. For example, the work of Marcotte  and similar work done by others attempt to define function in terms of the pathways and complexes in which the protein participates, rather than suggest a specific biochemical activity: in this framework a protein is associated with a function via its linkages to other proteins. Finally, in recent years, a fourth category has emerged. Here, one tackles the problem of protein function elucidation through the analysis of correlated mRNA expression of the type that is encountered in the context of DNA- and microarray-chip experiments. The underlying assumption is that functionally related proteins will exhibit correlated mRNA expression levels under multiple experimental settings. Consistent participation of a previously uncharacterized protein in clusters comprising proteins with a well-understood function imposes constraints on the unknown protein's possible behavior by restricting its candidate memberships within the context of a metabolic pathway . In principle, this method can help resolve a protein's function. A more recent variation of this general approach measures levels of protein expression (instead of mRNA) with the help of mass spectrometry or 2D gel electrophoresis in an attempt to determine clusters of strongly co-expressed proteins: these clusters can be used to determine the function of uncharacterized proteins. We next present and discuss a new approach to the problem of protein annotation. At the center of our approach is the Bio-Dictionary, an exhaustive collection of amino acid patterns, heretofore referred to as seqlets, that completely covers the natural sequence space of proteins to the extent that the latter is sampled by the currently available biological sequences. In earlier studies, we showed that the seqlets can capture both functional and structural signals that have been reused during evolution within and across families of related proteins. Our approach relies on the seqlets contained in the Bio-Dictionary and the associated information that is available in a well-maintained database such as SwissProt /TrEMBL , derives from an earlier prototype system we built to carry out similarity searching (,) and employs a weighted, position-specific scoring scheme that is not affected by the over-representation of well-conserved proteins and protein fragments that are present in the public databases. Although similar in intent to systems like GeneQuiz , our method goes beyond simply stating the presence of local and global similarities between a query and one or more database sequences: in fact, we also report information about the secondary structure characteristics of the query, the presence of known domains, signal peptides, active sites, post-translationally modified sites, cytoplasmic /extracellular behavior, the similarity of the query to each of the three phylogenetic domains as a function of amino acid position, etc. Figure 1 |  An example of incorrect protein annotation as a result of multiple domain sharing.  An example of incorrect protein annotation as a result of multiple domain sharing. The sequences have been aligned in a manner that shows their common domains. The 'd-arabino 3-hexulose 6-phosphate formaldehyde lyase' function has been propagated from the HUMS_BACSU sequence to the rest of the sequences in this group. Instances of the same domain have been shown in the sequences that contain it using the same color and shading scheme.
Background | The Bio-Dictionary idea was introduced and discussed in earlier works ( --); therein we described how one can use the Teiresias pattern discovery algorithm (,) to process a very large public database of amino acid sequences and fragments and derive a collection of amino acid patterns that, by design, appear within as well as across family boundaries. These patterns are referred to as seqlets and have been shown to capture functional and structural signals; moreover, they have the very important property of completely describing the processed input at the amino acid level. Following are some seqlet examples that include the name of the represented feature or of the represented protein family, taken from Rigoutsos et al. : GDG[IVAMTD]ND[AILV][PEAS] [AMV][LMIF]..A (cation-transporting ATPases), V.I.G. G..G...A (NAD /FAD-binding flavoproteins), G..G.GK[ST]TL (ATP /GTP-binding P-loop), KMSKS[LKDIR][GNDFQ]N (class I aminoacyl-tRNA synthetases), H.....HRD.K..N (serine /threonine protein kinases), etc. In terms of the notation used, [LKDIR] means a choice of exactly one among L, K, D, I and R, whereas '.' denotes a single position wild-card character that can replace any of the symbols in the alphabet. The derived collection of seqlets can thus be treated as a (redundant) vocabulary for the natural sequence space of proteins to the extent that the latter is uniformly sampled by the currently available biological sequences. Associating the entries of this vocabulary-like collection with the annotation information contained in a typical entry of the SwissProt database allows us to convert the collection into a dictionary. We have been using the term Bio-Dictionary to refer to the collection of seqlets that has been augmented so as to include the 'annotation meaning' for each of the entries. The key elements behind the Bio-Dictionary, and details of its construction, can be found in Rigoutsos et al. ; analysis of the 3D structural properties associated with the seqlets of a dictionary built out of 17 complete archaeal and bacterial genomes are given in Rigoutsos et al. ; finally, a discussion and description of potential uses for it appears in Rigoutsos et al. . In more recent work, we applied the Bio-Dictionary to in silico prokaryotic gene finding and built a system with exceptional performance : unlike approaches that are based on Markov models where each distinct genome requires that a different model be built, our gene finding system is universal in that a single instance of it is used across all archaeal and bacterial genomes.  The earlier work | By carrying out pattern discovery on a given sequence database D, we can use the generated pattern collection C to carry out similarity searches for instances of a query or its fragments in D as follows: a pattern from the derived collection C of patterns that matches a region of the query under consideration pinpoints a potential local similarity between the matched region of the query and all of the sequence fragments from the input database that the pattern represents (recall that by the definition of pattern discovery, patterns appear k or more times in the processed input, with k >= 2). In earlier work, we used the Teiresias algorithm to process Release 34 of the SwissProt database and built a prototype system for similarity searching using only a subset C' from the derived collection C of patterns. A given query sequence was examined for matches of patterns contained in C' and the query and database regions corresponding to the matches were aligned, scored, and finally sorted according to the computed score. Following the sorting, one could proceed in one of two distinct ways: (i) the user was presented with the collection of patterns that matched the query and was asked to identify those of biological importance, then alignments were generated using those patterns alone; (ii) those alignments that resulted from patterns whose database instances carried an associated annotation (namely the 'FT' line) were reported to the user for further study (,). This early system was meant to be a proof of concept. Consequently, complete coverage of the input database by the patterns in the collection C' was neither achieved nor pursued. As a matter of fact, this early system used a mere 565 432 patterns which covered similar50% of the processed SwissProt database at the amino acid level. Neither the existing over-representation of various protein families in the database nor the system's real-time performance were design considerations at that time. However, this early excursion provided an invaluable learning experience that helped guide us toward the system which we present next.  The method: description | The first and foremost consideration of the new approach is the achievement of a complete coverage of the natural sequence space as it is currently known. To that end we used as our domain of knowledge the 14 May 2001 release of SwissProt /TrEMBL, a large, publicly available and curated database . This particular release comprised 532 621 amino acid sequences and fragments with a grand total of 170 762 058 amino acids. We processed this input database in two phases. First, we ran Teiresias using L = 8, W = 8 and K = 2 and generated variable length seqlets that contained no wild-cards. For each one of these seqlets, we located and masked all of its instances in the input database except for the one that appeared in the longest among the sequences containing instances of the seqlet. We then reran Teiresias on the masked input, but this time using L = 6 and W = 15. For more information about this scheme and other methodological details the reader is referred to Rigoutsos et al. . The processing required similar45 CPU days worth of computation using IBM RS64III processors with a clock speed of 450 MHz. With the help of a parallel implementation of Teiresias that we have developed for shared memory architectures, we completed this computation in 2 days on a 24 processor IBM S-80 supercomputer. The two pattern discovery phases generated the Bio-Dictionary that we used in our analysis and which contained a combined total of 42 996 454 seqlets [compare the size of the current collection with the 565 432 patterns used in Floratos et al. (,)] that accounted for 98.2% of the processed input at the amino acid level (this degree of coverage essentially implies that, on average, a mere five amino acids per protein sequence cannot be accounted for by this seqlet collection). The length and density distributions of these seqlets match closely the ones shown in Rigoutsos et al. , whereas the average length of a seqlet is similar12 --13 amino acids. It should be noted that this Bio-Dictionary contains redundant seqlets, i.e. a given amino acid position in the processed input will typically participate in and is covered by multiple seqlets; this redundancy of representation is a desired property which we exploit during annotation. Each seqlet in the collection carries along the meaning(s) associated with the regions of the proteins that contained an instance of and gave rise to the seqlet. Instead of a static description of each seqlet's meaning(s) in the manner that we described in Rigoutsos et al. , we opted for composing the full entry of each seqlet during the run time as required. We currently derive labels for meanings from only the DE, OC and FT lines of the respective SwissProt /TrEMBL entry; obviously, we can tap into any database containing complementary information and attach additional meanings to each seqlet. One obvious choice is the PDB (,): in previous publications (,) we described how 3D structure can be associated with seqlets and are currently in the process of extending the approach presented herein in order to reconstruct local 3D structure using the structural hypotheses generated by partially overlapping seqlets (D.Platt, I.Rigoutsos, Y.Gao and L.Parida, submitted for publication). Recall that the DE or 'description' line of SwissProt contains general descriptive information about the respective entry. Similarly, the OC or 'organism classification' line contains the taxonomic classification of the source organism. And the FT or 'feature table' line contains a simple and precise means for the annotation of the sequence data: a fixed abbreviation with a defined meaning relating to the feature being reported is followed by the residue numbers indicating the end points (extent) of the named feature; the line ends with a description containing additional information about the feature. Of the available SwissProt /TrEMBL abbreviations contained in an FT line we only make use of the ones listed in Table . When presented with a query Q to annotate, we carry out the steps outlined in Figure , a markedly different approach than the one used in our early prototype. First, we generate the 'intersection' of the Bio-Dictionary with the query sequence to find those seqlets that match somewhere in the query. For each of the seqlets in this intersection, we examine the corresponding SwissProt /TrEMBL entries for all of the sequences that gave rise to the seqlet during the Bio-Dictonary formation, thus building the corresponding dictionary entry 'on-the-fly' by dynamically attaching to the seqlet all the meaning(s) extracted from those entries. The extracted meanings essentially 'color' each seqlet and by extension the region of the query where the seqlet matches. Note that a given seqlet can carry multiple 'colors', i.e. attributes. Con sequently, a region of the query can be associated with multiple attributes. If the seqlet under consideration is attached to an attribute that has not been encountered before, then a new attribute vector is introduced: the attribute vector has the same length as the query and initially contains zeroes everywhere; the current seqlet assigns its contribution CONTRIB(.,.) to this new attribute vector at precisely the region corresponding to the seqlet's match in the query. If the seqlet carries an attribute that has been encountered before, the seqlet adds its contribution CONTRIB(.,.) to the appropriate region of the already existing attribute vector. Multiple seqlets that carry the same attribute will add their individual contributions to the attribute's vector: the regions to which the seqlets contribute may or may not be overlapping. The manner in which we decide what amount a seqlet will contribute to an attribute vector is described in detail below. After all seqlets in the intersection have been exhausted, and separately for each attribute category (e.g. DE, FT, etc.), the attribute vectors are sorted and ranked based on the accumulated support and the top T ranking vectors of the category are reported (T is a user-specified parameter). Each of these vectors will contain non-zero values at precisely those regions that were matched by possibly overlapping, distinct seqlets that carried the same attribute. Before we describe the scoring scheme it is important to stress some points that are particular to our work. In general, the Bio-Dictionary should not be seen as a collection of seqlets each of which necessarily captures a specific feature such as a kinase domain, a metal binding site, etc. Seqlets that can act as predicates for a feature or protein family do exist in the Bio-Dictionary, but, by design, seqlets may also carry multiple meanings. This is different from the one-to-one correspondence that the reader may be accustomed to and which is typical of predicate-containing databases such as PROSITE, PRINTS and INTERPRO (,,). As we showcased previously , a seqlet can cross functional and structural boundaries and can thus be associated with multiple meanings. Clearly, those of the seqlets that are associated with a unique meaning can function as predicates, but a significant number of them will capture and correspond to multiple meanings. Similarly, the Bio-Dictionary also contains multiple seqlets all of which capture the same meaning. These seqlets can also have instances that overlap with one another, as indicated by the fact that the product of the number of seqlets contained in the Bio-Dictionary times the seqlets' average length is a multiple of the actual length of the processed input . Thus, by design, a given position of a processed query will in general be covered by multiple seqlets. Each of the seqlets covering a position within the query will in general carry one or more meanings that are used to 'color' the corresponding region of the query. Let a given query position be covered by M distinct seqlets. In order for an attribute, e.g. 'metal-binding site', to rank high in the reported results, a large portion of those M seqlets must carry this attribute. Recall that, by definition, each of the seqlets of the Bio-Dictionary appears in at least two places in the processed database (SwissProt /TrEMBL in our case): thus, if M seqlets cover a given position in the query to annotate, then the following two properties will simultaneously hold: *there exists a total of F sequence fragments corresponding to all of the instances of the M seqlets in the processed input database; clearly, these fragments will be similar to the amino acid neighborhood surrounding this query position; *the F sequence fragments in the database will agree on the amino acid identity of the literals (recall that the seqlets contain both literals and wild-cards, i.e. 'dots') contained in each of the M seqlets. These database sequence fragments may or may not agree on the annotation of the query position under consideration. If the annotations for N of these F database sequence fragments state that this site is a metal-binding site then through application of the 'guilty by association' approach, our belief that this query position is also a metal-binding site will be proportional to N /F. This very idea is applied to every attribute and attribute category that is attached to a seqlet. The direct implication of this is that a seqlet can be useful and able to contribute to a specific annotation without having to span an attribute (e.g. protein kinase domain) in its entirety. Moreover, the seqlet does not have to be a predicate for an attribute either. Figure  graphically depicts this situation. For discussion purposes, let us assume that when we searched the query Q with the Bio-Dictionary, we determined that seqletK is present in Q in the region [qfrom, qto]. Let us also assume that during the Bio-Dictionary formation, seqletK was determined to have three instances in the processed SwissProt /TrEMBL database. After following these three backpointers to the full entries of the sequences that contain the three instances of seqletK, we determine that in one of the sequences the seqlet instance spans an interval [pfrom, pto] that has a non-empty intersection with a specific region [featfrom, featto] of that sequence that is annotated as np_bind atp, i.e. as an ATP-binding site. Let [ifrom, ito] denote the intersection of the intervals [pfrom, pto] and [featfrom, featto]. In this example, seqletK will corroborate the presence of a partial ATP-binding domain in the query that is being annotated by incrementing the support at the locations [qfrom + (ifrom  -- pfrom), qfrom + (ito  -- pfrom)] of the np_bind atp attribute vector. It should now be clear why any given seqlet does not have to serve as a predicate for the attribute(s) that it corroborates. The term 'attribute' is overloaded in our discussion and should be interpreted rather loosely: it can mean a local similarity, a global similarity, an active site, a phylogenetic domain, a post-translationally modified location, etc. If the query being annotated contains a true instance of a given attribute, then each one of the numerous seqlets that will cover the region spanned by the attribute more than once will cumulatively and independently provide support for the attribute at the respective positions: as the accumulated support for the attribute increases so does the likelihood of its presence in the query. If the query is a true member of a known protein family, then we expect the attribute vector for this family to obtain support along its entire length from practically every single one of the seqlets that match in this query. If a query contains a known domain, then the attribute vector for the domain will have non-zero support over the region of the query that corresponds to the domain's instance. In an analogous manner, if the processed query shares only a local region with a well-characterized family or an individual protein, then the corresponding attribute vector will have non-zero support only over the shared region. The manner in which we use the seqlets and accumulate scores has proven particularly useful in situations that, among others, include the following: the query is a fragment of a known sequence; the query contains one or more known domains in a novel order; the query has been assembled using an incorrect exon collection (e.g. one or more true exons are missing, introns have been mislabeled as exons and included in the assembly, exons that correspond to distinct genes have been assembled together, etc.). Moreover, the fact that our seqlets have lengths that typically span between 6 and 18 amino acids (for a detailed discussion see ) permits us to easily and correctly process very short input queries, e.g. 8 --10 amino acids, without the thresholding constraints and limitations that one typically encounters when using heuristics-based similarity search algorithms (,). In real-world applications, situations arise where the query represents or contains only a fragment from a known domain, for example a query involving the first few tens of amino acids from say a 'protein kinase domain'. In order to alert the user to this situation, we also include, wherever applicable, the 'minimum', 'average' and 'standard deviation' values for the span of each of the T top ranking reported attribute vectors. This permits easy determination of whether the query represents a complete instance of the stated attribute or only a fragment.  The method: scoring | How much to contribute. Above we described how we determine the extent of an attribute vector region to which a seqlet matching the query will contribute. We now discuss how we determine the amount that the seqlet will contribute. Let seqletK be present in query Q and let qi1qi2qi3...qil and pj1pj2pj3...pjl be its instances in the query and in some database sequence d, respectively; let {i1, ... il} and {j1, ... jl} denote the indices of the positions spanned by the seqlet in the query Q and sequence d, respectively. For simplicity, we will assume that the instance of seqletK completely spans an annotated region of d that corresponds to an attribute A. SeqletK brings together two sequence fragments with lengths equal to the span of the seqlet; one fragment comes from the query that is being analyzed while the other is from the sequence d of the database. Obviously, the more similar these two fragments are the more likely it is that upon completion of the annotation process the attribute A that is associated with the database region pj1pj2pj3...pjl will be carried over to the query region qi1qi2qi3...qil through the 'guilty by association' approach. There is a rather straightforward manner in which seqletK can contribute to the vector for attribute A; we simply use one of the available scoring matrices and generate contributions in a position- and content-dependent manner as follows: for m = 1 to l {attribute_vector[i1 + m  -- 1] += f(scoring_matrix[qi1 + m  -- 1][pj1 + m  -- 1])} (the symbol += is shorthand notation for 'increment by amount shown on the right of the = sign'). In other words, the seqlet will contribute to the (i1 + m  -- 1)th position of the attribute vector an amount that relates to the degree of similarity between the amino acids occupying the positions qi1 + m  -- 1 and pj1 + m  -- 1, respectively. A good choice for the function f(.) above is f(x) = 2x + constant; with regard to the scoring matrix to use one can employ any of the standard PAM or BLOSUM scoring matrices (,). In order to avoid the over-counting that would be the consequence of a given protein family or fragment being over-represented in the SwissProt /TrEMBL database, we impose the additional constraint that a given seqlet cannot contribute to the same attribute vector and vector position(s) more than once. In other words, if seqletK captures a very well-conserved region appearing in a large number of SwissProt /TrEMBL sequences, only one of the seqlet's numerous annotated database instances will contribute to the respective attribute vector. How to normalize. As mentioned already, a given seqlet with distinct possible meanings will contribute in turn to each of the attribute vectors that correspond to those meanings. And these contributions will depend on how well a known database instance of the attribute matches its alleged instance in the query. Different attribute vectors will accumulate different amounts of contribution and these contributions will also depend on the position within the attribute vector. During the annotation of the query we maintain a book-keeping array, total_contrib, with length equal to that of the query; for every seqlet with an instance qi1qi2qi3...qil in the query, we update total as follows: for m = 1 to l {total_contrib[i1 + m  -- 1] += f(scoring_matrix[qi1 + m  -- 1][pj1 + m  -- 1])} In other words, the ith position of total_contrib is a measure of the number of seqlets that contribute to it, with each contribution weighted by the degree of similarity between the amino acids in the query and their input database counterparts. The function f(.) is the same as in the previous section. Note that at all times during processing, the value of total_contrib[i] is greater than or equal to the maximum value one will encounter in the ith position of any of the active attribute vectors for this query. Once all of the seqlets matching the query have been examined, we normalize the contents of the ith position of e